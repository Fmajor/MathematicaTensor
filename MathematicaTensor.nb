(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     90047,       2131]
NotebookOptionsPosition[     89561,       2110]
NotebookOutlinePosition[     90069,       2130]
CellTagsIndexPosition[     90026,       2127]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<Author: wujin\\nEmail:wujinnnnn@gmail.com\\n\>\"",
   "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"listSize", "[", "inputList_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dims", ",", "tempDim", ",", "tempList"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dims", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tempList", "=", "inputList"}], ";", "\[IndentingNewLine]", 
      RowBox[{"tempDim", "=", 
       RowBox[{"Dimensions", "[", "tempList", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ListQ", "[", "tempList", "]"}], "&&", 
         RowBox[{"tempDim", "\[NotEqual]", "  ", 
          RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"dims", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"dims", ",", 
            RowBox[{"tempDim", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"tempList", "=", 
          RowBox[{"tempList", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"tempDim", "=", 
          RowBox[{"Dimensions", "[", "tempList", "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "dims", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stringSubscript", "[", 
    RowBox[{"initString_", ",", "SubString_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"temp", ",", "output"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"temp", "=", "initString"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"temp", ",", "1"}], "]"}], "\[Equal]", "\"\<\\!\>\""}], ",", 
        RowBox[{"temp", "=", 
         RowBox[{"StringDrop", "[", 
          RowBox[{"temp", ",", "1"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         TagBox[
          
          StyleBox[
           "\"\<\\!\\(\\*SubscriptBox[\\(initString\\), \\(toSubString\\)]\\)\
\>\"",
           ShowSpecialCharacters->False,
           ShowStringCharacters->True,
           NumberMarks->True],
          FullForm], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<initString\>\"", "\[Rule]", "temp"}], ",", 
           RowBox[{"\"\<toSubString\>\"", "\[Rule]", "SubString"}]}], "}"}]}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "output", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stringSuperscript", "[", 
    RowBox[{"initString_", ",", "superString_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"temp", ",", "output"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"temp", "=", "initString"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"temp", ",", "1"}], "]"}], "\[Equal]", "\"\<\\!\>\""}], ",", 
        RowBox[{"temp", "=", 
         RowBox[{"StringDrop", "[", 
          RowBox[{"temp", ",", "1"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         TagBox[
          
          StyleBox[
           "\"\<\\!\\(\\*SuperscriptBox[\\(initString\\), \
\\(toSubString\\)]\\)\>\"",
           ShowSpecialCharacters->False,
           ShowStringCharacters->True,
           NumberMarks->True],
          FullForm], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<initString\>\"", "\[Rule]", "temp"}], ",", 
           RowBox[{"\"\<toSubString\>\"", "\[Rule]", "superString"}]}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "output", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"generateIndex", "[", 
    RowBox[{"sym_", ",", "indexBQ_", ",", "characterBQ_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "output", ",", "index", ",", "character"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"StringQ", "[", "indexBQ", "]"}], ",", 
        RowBox[{"index", "=", 
         RowBox[{"Characters", "[", "indexBQ", "]"}]}], ",", 
        RowBox[{"index", "=", "indexBQ"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"StringQ", "[", "characterBQ", "]"}], ",", 
        RowBox[{"character", "=", 
         RowBox[{"Characters", "[", "characterBQ", "]"}]}], ",", 
        RowBox[{"character", "=", "characterBQ"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "index", "]"}], "\[NotEqual]", 
         RowBox[{"Length", "[", "character", "]"}]}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<generateIndex:dimension not right!!\>\"", "]"}], 
         ";", 
         RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"AllTrue", "[", 
          RowBox[{"character", ",", "StringQ"}], "]"}]}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<generateIndex:character must be Strings!!!\>\"", ";", 
          RowBox[{"Return", "[", "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "index", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"output", "=", "sym"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "n"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"index", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<u\>\""}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"output", "=", 
           RowBox[{"stringSuperscript", "[", 
            RowBox[{"output", ",", 
             RowBox[{"character", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"index", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<d\>\""}], ",", 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"output", "=", 
             RowBox[{"stringSubscript", "[", 
              RowBox[{"output", ",", 
               RowBox[{"character", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<characters must be u or d\>\"", "]"}],
              ";", 
             RowBox[{"Return", "[", "]"}]}]}], "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "output", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"generateTensorTable", "[", 
    RowBox[{"sym_", ",", "ind_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "output", ",", "n", ",", "todoString", ",", "pairs", ",", "indexTable", 
       ",", "result", ",", "index"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"output", "=", "\"\<T\>\""}], ";", "\[IndentingNewLine]", 
      RowBox[{"index", "=", "ind"}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{
        RowBox[{"Dimensions", "[", "dim", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "todoString", "=", 
       "\"\<Table[generateIndex[\\\"sym\\\",index,indexTable],pairs]\>\""}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"indexTable", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"\"\<ToString[\>\"", "<>", "\"\<i\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<]\>\""}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "//", "ToString"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"pairs", "=", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<i\>\"", "<>", 
               RowBox[{"ToString", "[", "i", "]"}]}], ",", 
              RowBox[{"dim", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "//", "ToString"}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"pairs", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<i\>\"", "<>", 
             RowBox[{"ToString", "[", "i", "]"}]}], ",", "0", ",", 
            RowBox[{
             RowBox[{"dim", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "//", "ToString"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"pairs", "=", 
       RowBox[{"StringTake", "[", 
        RowBox[{"pairs", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"todoString", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"todoString", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<sym\>\"", "\[Rule]", "sym"}], ",", 
           RowBox[{"\"\<indexTable\>\"", "->", "indexTable"}], ",", 
           RowBox[{"\"\<pairs\>\"", "->", "pairs"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "todoString", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"ToExpression", "[", "todoString", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "result", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "table", ",", "index", ",", "dim", ",", "sym", ",", "indexString", ",", 
     "symTable"}], "}"}], ",", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{
     RowBox[{"table", "[", "_", "]"}], "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"symTable", "[", "_", "]"}], "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"index", "[", "_", "]"}], "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"dim", "[", "_", "]"}], "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"sym", "[", "_", "]"}], "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"indexString", "[", "_", "]"}], "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Tensor", "/:", 
     RowBox[{"new", "[", 
      RowBox[{"Tensor", "[", 
       RowBox[{"ind_", ",", "dim_"}], "]"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"temp", ",", "tempTable", ",", "initTable"}], "}"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"Tensor", "[", 
          RowBox[{"Unique", "[", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"temp", ".", 
         RowBox[{"setIndex", "[", "ind", "]"}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"temp", ".", 
         RowBox[{"setDim", "[", "dim", "]"}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"temp", ".", 
         RowBox[{"setSym", "[", "\"\<T\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"initTable", "=", 
         StyleBox[
          RowBox[{"generateTensorTable", "[", 
           RowBox[{"\"\<T\>\"", ",", "ind", ",", "dim"}], "]"}],
          FontWeight->"Plain"]}], 
        StyleBox[";",
         FontWeight->"Plain"], "\[IndentingNewLine]", "\t", 
        RowBox[{"temp", ".", 
         RowBox[{"setTable", "[", 
          StyleBox["initTable",
           FontWeight->"Plain"], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"temp", ".", 
         RowBox[{"setSymTable", "[", "initTable", "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Return", "[", "temp", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Tensor", "/:", 
     RowBox[{"new", "[", 
      RowBox[{"Tensor", "[", 
       RowBox[{"ind_", ",", "dim_", ",", "initTable_"}], "]"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"temp", ",", "tempTable"}], "}"}], ",", "\[IndentingNewLine]",
        "\t", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"Tensor", "[", 
          RowBox[{"Unique", "[", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"temp", ".", 
         RowBox[{"setIndex", "[", "ind", "]"}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"temp", ".", 
         RowBox[{"setDim", "[", "dim", "]"}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"temp", ".", 
         RowBox[{"setSym", "[", "\"\<T\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"temp", ".", 
         RowBox[{"setTable", "[", 
          StyleBox["initTable",
           FontWeight->"Plain"], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"temp", ".", 
         RowBox[{"setSymTable", "[", 
          StyleBox[
           RowBox[{"generateTensorTable", "[", 
            RowBox[{"\"\<T\>\"", ",", "ind", ",", "dim"}], "]"}],
           FontWeight->"Plain"], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Return", "[", "temp", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Tensor", "/:", 
     RowBox[{
      RowBox[{"Tensor", "[", "tag_", "]"}], ".", 
      RowBox[{"setIndex", "[", "value_", "]"}]}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "test", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"index", "[", "tag", "]"}], "=", 
         RowBox[{"Characters", "[", "value", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"indexString", "[", "tag", "]"}], "=", "value"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"test", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "\[Equal]", "\"\<u\>\""}], "||", 
             RowBox[{"#", "\[Equal]", "\"\<d\>\""}]}], "&"}], ",", 
           RowBox[{"index", "[", "tag", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"AllTrue", "[", 
            RowBox[{"test", ",", "TrueQ"}], "]"}]}], ",", 
          RowBox[{
          "Print", "[", 
           "\"\<setIndex:Error!!!!!!!!!!!!!!!!!!!!index should be like \
uuuduudud!!!!\>\"", "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Tensor", "/:", 
     RowBox[{
      RowBox[{"Tensor", "[", "tag_", "]"}], ".", 
      RowBox[{"showIndex", "[", "]"}]}], ":=", 
     RowBox[{"index", "[", "tag", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Tensor", "/:", 
     RowBox[{
      RowBox[{"Tensor", "[", "tag_", "]"}], ".", 
      RowBox[{"showIndexString", "[", "]"}]}], ":=", 
     RowBox[{"indexString", "[", "tag", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Tensor", "/:", 
     RowBox[{
      RowBox[{"Tensor", "[", "tag_", "]"}], ".", 
      RowBox[{"setDim", "[", "value_", "]"}]}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"length", ",", "inputLength"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"length", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"index", "[", "tag", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"inputLength", "=", 
         RowBox[{"Length", "[", "value", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dim", "[", "tag", "]"}], "=", "value"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"length", "\[NotEqual]", "inputLength"}], ",", 
          RowBox[{
          "Print", "[", "\"\<setDim:Dimension Error!!!!!!!!!!!!!!!!!!!\>\"", 
           "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Tensor", "/:", 
     RowBox[{
      RowBox[{"Tensor", "[", "tag_", "]"}], ".", 
      RowBox[{"showDim", "[", "]"}]}], ":=", 
     RowBox[{"dim", "[", "tag", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Tensor", "/:", 
     RowBox[{
      RowBox[{"Tensor", "[", "tag_", "]"}], ".", 
      RowBox[{"setToScale", "[", 
       RowBox[{"l_", ",", "thesym_"}], "]"}]}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"table", "[", "tag", "]"}], "=", "l"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"symTable", "[", "tag", "]"}], "=", "thesym"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"indexString", "[", "tag", "]"}], "=", "\"\<Scale\>\""}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"index", "[", "tag", "]"}], "=", 
         RowBox[{"{", "\"\<Scale\>\"", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dim", "[", "tag", "]"}], "=", 
         RowBox[{"{", "1", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sym", "[", "tag", "]"}], "=", "thesym"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Tensor", "/:", 
     RowBox[{
      RowBox[{"Tensor", "[", "tag_", "]"}], ".", 
      RowBox[{"setTable", "[", "value_", "]"}]}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "size", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"size", "=", 
         RowBox[{"listSize", "[", "value", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"size", "\[Equal]", " ", 
           RowBox[{"dim", "[", "tag", "]"}]}], ",", 
          RowBox[{
           RowBox[{"table", "[", "tag", "]"}], "=", "value"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<setTable:Error Init Tensor!!\>\"", "]"}], ";", 
           RowBox[{"Print", "[", "size", "]"}]}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Tensor", "/:", 
     RowBox[{
      RowBox[{"Tensor", "[", "tag_", "]"}], ".", 
      RowBox[{"showTable", "[", "]"}]}], ":=", 
     RowBox[{"table", "[", "tag", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Tensor", "/:", 
     RowBox[{
      RowBox[{"Tensor", "[", "tag_", "]"}], ".", 
      RowBox[{"setSymTable", "[", "value_", "]"}]}], ":=", 
     RowBox[{
      RowBox[{"symTable", "[", "tag", "]"}], "=", "value"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Tensor", "/:", 
     RowBox[{
      RowBox[{"Tensor", "[", "tag_", "]"}], ".", 
      RowBox[{"showSymTable", "[", "]"}]}], ":=", 
     RowBox[{"symTable", "[", "tag", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Tensor", "/:", 
     RowBox[{
      RowBox[{"Tensor", "[", "tag_", "]"}], ".", 
      RowBox[{"setSym", "[", "value_", "]"}]}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Tensor", "[", "tag", "]"}], ".", 
         RowBox[{"setSymTable", "[", 
          StyleBox[
           RowBox[{"generateTensorTable", "[", 
            RowBox[{"value", ",", 
             RowBox[{
              RowBox[{"Tensor", "[", "tag", "]"}], ".", 
              RowBox[{"showIndexString", "[", "]"}]}], ",", 
             RowBox[{
              RowBox[{"Tensor", "[", "tag", "]"}], ".", 
              RowBox[{"showDim", "[", "]"}]}]}], "]"}],
           FontWeight->"Plain"], 
          StyleBox["]",
           FontWeight->"Plain"]}]}], 
        StyleBox[";",
         FontWeight->"Plain"], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sym", "[", "tag", "]"}], "=", "value"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Tensor", "/:", 
     RowBox[{
      RowBox[{"Tensor", "[", "tag_", "]"}], ".", 
      RowBox[{"showEqu", "[", "]"}]}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "theVal", ",", "theSym", ",", "theLen", ",", "theEQString", ",", 
         "theValString", ",", "temp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"indexString", "[", "tag", "]"}], "\[Equal]", " ", 
           "\"\<Scale\>\""}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Return", "[", 
            RowBox[{
             RowBox[{"sym", "[", "tag", "]"}], "<>", "\"\<=\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"table", "[", "tag", "]"}], ",", "TraditionalForm"}], 
              "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"table", "[", "tag", "]"}], "=", 
         RowBox[{"Simplify", "[", 
          RowBox[{"table", "[", "tag", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"theVal", "=", 
         RowBox[{"table", "[", "tag", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"theSym", "=", 
         RowBox[{"symTable", "[", "tag", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"theLen", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"dim", "[", "tag", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"genEqu", "[", "t__", "]"}], ":=", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"Return", "[", "\"\<=\>\"", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"theEQString", "=", 
         RowBox[{"Array", "[", 
          RowBox[{"genEqu", ",", 
           RowBox[{"dim", "[", "tag", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"theVal", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"{", "theVal", "}"}], ",", 
           RowBox[{"indexShiftRight", "[", 
            RowBox[{
             RowBox[{"theLen", "+", "1"}], ",", "1"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"theValString", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{"#", ",", "TraditionalForm"}], "]"}], "&"}], ",", 
           "theVal", ",", 
           RowBox[{"{", "theLen", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"temp", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"StringJoin", ",", 
           RowBox[{"{", 
            RowBox[{"theSym", ",", "theEQString"}], "}"}], ",", "theLen"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"temp", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"StringJoin", ",", 
           RowBox[{"{", 
            RowBox[{"temp", ",", "theValString"}], "}"}], ",", "theLen"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "temp", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Tensor", "/:", 
     RowBox[{
      RowBox[{"Tensor", "[", "tag_", "]"}], ".", 
      RowBox[{"showSym", "[", "]"}]}], ":=", 
     RowBox[{"sym", "[", "tag", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Tensor", "/:", 
     RowBox[{
      RowBox[{"Tensor", "[", "tag_", "]"}], ".", 
      RowBox[{"simplifyTable", "[", "]"}]}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"table", "[", "tag", "]"}], "=", 
         RowBox[{"Simplify", "[", 
          RowBox[{"table", "[", "tag", "]"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Tensor", "/:", 
     RowBox[{
      RowBox[{"Tensor", "[", "tag_", "]"}], ".", 
      RowBox[{"info", "[", "]"}]}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<index: \>\"", "<>", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Tensor", "[", "tag", "]"}], ".", 
            RowBox[{"showIndexString", "[", "]"}]}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<dimensions: \>\"", ",", 
          RowBox[{
           RowBox[{"Tensor", "[", "tag", "]"}], ".", 
           RowBox[{"showDim", "[", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\"\<symbol table:\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"Tensor", "[", "tag", "]"}], ".", 
          RowBox[{"showSymTable", "[", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\"\<value table\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"Tensor", "[", "tag", "]"}], ".", 
          RowBox[{"showTable", "[", "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tensorProduct", "[", 
   RowBox[{"t1_", ",", "t2_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "str1", ",", "str2", ",", "dims", ",", "table1", ",", "table2", ",", 
      "timeForm", ",", "iList1", ",", "iList2", ",", "pairs", ",", 
      "todoString", ",", "n1", ",", "n2", ",", "result"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str1", "=", 
      RowBox[{"t1", ".", 
       RowBox[{"showIndexString", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"str2", "=", 
      RowBox[{"t2", ".", 
       RowBox[{"showIndexString", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"table1", "=", 
      RowBox[{"t1", ".", 
       RowBox[{"showTable", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"table2", "=", 
      RowBox[{"t2", ".", 
       RowBox[{"showTable", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dims", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"t1", ".", 
         RowBox[{"showDim", "[", "]"}]}], ",", 
        RowBox[{"t2", ".", 
         RowBox[{"showDim", "[", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n1", "=", 
      RowBox[{"StringLength", "[", "str1", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n2", "=", 
      RowBox[{"StringLength", "[", "str2", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"todoString", "=", "\"\<Table[timeForm,pairs]\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"iList1", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\"\<i\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n1"}], "}"}]}], "]"}], "//", 
       "ToString"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"iList2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\"\<i\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"n1", "+", "1"}], ",", 
           RowBox[{"n1", "+", "n2"}]}], "}"}]}], "]"}], "//", "ToString"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"iList1", "=", 
      RowBox[{"StringTake", "[", 
       RowBox[{"iList1", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"iList2", "=", 
      RowBox[{"StringTake", "[", 
       RowBox[{"iList2", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"timeForm", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"\"\<Times[table1[[iList1]],table2[[iList2]]]\>\"", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<iList1\>\"", "\[Rule]", "iList1"}], ",", 
          RowBox[{"\"\<iList2\>\"", "\[Rule]", "iList2"}]}], "}"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"pairs", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<i\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}]}], ",", 
           RowBox[{"dims", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"n1", "+", "n2"}]}], "}"}]}], "]"}], "//", "ToString"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"pairs", "=", 
      RowBox[{"StringTake", "[", 
       RowBox[{"pairs", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"todoString", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"todoString", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<timeForm\>\"", "->", "timeForm"}], ",", 
          RowBox[{"\"\<pairs\>\"", "->", "pairs"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"ToExpression", "[", "todoString", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"new", "[", 
       RowBox[{"Tensor", "[", 
        RowBox[{
         RowBox[{"str1", "<>", "str2"}], ",", "dims", ",", "result"}], "]"}], 
       "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tensorSymProduct", "[", 
   RowBox[{"t1_", ",", "t2_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "str1", ",", "str2", ",", "dims", ",", "table1", ",", "table2", ",", 
      "timeForm", ",", "iList1", ",", "iList2", ",", "pairs", ",", 
      "todoString", ",", "n1", ",", "n2", ",", "result"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str1", "=", 
      RowBox[{"t1", ".", 
       RowBox[{"showIndexString", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"str2", "=", 
      RowBox[{"t2", ".", 
       RowBox[{"showIndexString", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"table1", "=", 
      RowBox[{"t1", ".", 
       RowBox[{"showTable", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"table2", "=", 
      RowBox[{"t2", ".", 
       RowBox[{"showTable", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dims", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"t1", ".", 
         RowBox[{"showDim", "[", "]"}]}], ",", 
        RowBox[{"t2", ".", 
         RowBox[{"showDim", "[", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n1", "=", 
      RowBox[{"StringLength", "[", "str1", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n2", "=", 
      RowBox[{"StringLength", "[", "str2", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"todoString", "=", "\"\<Table[timeForm,pairs]\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"iList1", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\"\<i\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n1"}], "}"}]}], "]"}], "//", 
       "ToString"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"iList2", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\"\<i\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"n1", "+", "1"}], ",", 
           RowBox[{"n1", "+", "n2"}]}], "}"}]}], "]"}], "//", "ToString"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"iList1", "=", 
      RowBox[{"StringTake", "[", 
       RowBox[{"iList1", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"iList2", "=", 
      RowBox[{"StringTake", "[", 
       RowBox[{"iList2", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"timeForm", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"\"\<table1[[iList1]]<>table2[[iList2]]\>\"", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<iList1\>\"", "\[Rule]", "iList1"}], ",", 
          RowBox[{"\"\<iList2\>\"", "\[Rule]", "iList2"}]}], "}"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"pairs", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<i\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}]}], ",", 
           RowBox[{"dims", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"n1", "+", "n2"}]}], "}"}]}], "]"}], "//", "ToString"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"pairs", "=", 
      RowBox[{"StringTake", "[", 
       RowBox[{"pairs", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"todoString", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"todoString", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<timeForm\>\"", "->", "timeForm"}], ",", 
          RowBox[{"\"\<pairs\>\"", "->", "pairs"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"ToExpression", "[", "todoString", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "result", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tensorContract", "[", 
    RowBox[{"t_Tensor", ",", "indexToContract_List"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "str", ",", "dims", ",", "table", ",", "n", ",", "allIndex", ",", "i1", 
       ",", "i2", ",", "ii", ",", "dimEqual", ",", "theDim", ",", "newDims", 
       ",", "newAnotherAllIndex", ",", "newStr", ",", "todoString", ",", 
       "timeForm", ",", "newAllIndexNumber", ",", "pairs", ",", 
       "allIndexNumber", ",", "result", ",", "temp"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"str", "=", 
       RowBox[{"t", ".", 
        RowBox[{"showIndexString", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dims", "=", 
       RowBox[{"t", ".", 
        RowBox[{"showDim", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"table", "=", 
       RowBox[{"t", ".", 
        RowBox[{"showTable", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"StringLength", "[", "str", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"allIndexNumber", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"allIndex", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\"\<i\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"i1", "=", 
       RowBox[{"indexToContract", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"i2", "=", 
       RowBox[{"indexToContract", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dimEqual", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dims", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], "\[Equal]", " ", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"theDim", "=", 
       RowBox[{"dims", "[", 
        RowBox[{"[", "i1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"str", ",", 
                  RowBox[{"{", 
                   RowBox[{"i1", ",", "i1"}], "}"}]}], "]"}], "\[Equal]", 
                "\"\<u\>\""}], "&&", 
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"str", ",", 
                  RowBox[{"{", 
                   RowBox[{"i2", ",", "i2"}], "}"}]}], "]"}], "\[Equal]", 
                "\"\<d\>\""}]}], ")"}], "||", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"str", ",", 
                  RowBox[{"{", 
                   RowBox[{"i1", ",", "i1"}], "}"}]}], "]"}], "\[Equal]", 
                "\"\<d\>\""}], "&&", 
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"str", ",", 
                  RowBox[{"{", 
                   RowBox[{"i2", ",", "i2"}], "}"}]}], "]"}], "\[Equal]", 
                "\"\<u\>\""}]}], ")"}]}], ")"}], "&&", "dimEqual"}], ")"}]}], 
        ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<tensorContract:only u index and d index can contract!!!!!!!!!!\
\\nOr dimension not Equal!!\>\"", "]"}], ";", 
         RowBox[{"Return", "[", "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"temp", "=", 
          RowBox[{"new", "[", 
           RowBox[{"Tensor", "[", 
            RowBox[{"\"\<u\>\"", ",", 
             RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"result", "=", 
          RowBox[{"Tr", "[", 
           RowBox[{"t", ".", 
            RowBox[{"showTable", "[", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"result", "=", 
            RowBox[{"Simplify", "[", "result", "]"}]}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"temp", ".", 
          RowBox[{"setToScale", "[", 
           RowBox[{"result", ",", 
            RowBox[{"t", ".", 
             RowBox[{"showSym", "[", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "temp", "]"}], ";"}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"newDims", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{"dims", ",", 
           RowBox[{"{", 
            RowBox[{"i1", ",", "i1"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i2", "-", "1"}], ",", 
           RowBox[{"i2", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newAllIndexNumber", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{"allIndexNumber", ",", 
           RowBox[{"{", 
            RowBox[{"i1", ",", "i1"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i2", "-", "1"}], ",", 
           RowBox[{"i2", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newAnotherAllIndex", "=", 
       RowBox[{
        RowBox[{"ReplacePart", "[", 
         RowBox[{"allIndex", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"i1", "\[Rule]", "\"\<ii\>\""}], ",", 
            RowBox[{"i2", "\[Rule]", "\"\<ii\>\""}]}], "}"}]}], "]"}], "//", 
        "ToString"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newStr", "=", 
       RowBox[{"StringDrop", "[", 
        RowBox[{
         RowBox[{"StringDrop", "[", 
          RowBox[{"str", ",", 
           RowBox[{"{", 
            RowBox[{"i1", ",", "i1"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i2", "-", "1"}], ",", 
           RowBox[{"i2", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newAnotherAllIndex", "=", 
       RowBox[{"StringTake", "[", 
        RowBox[{"newAnotherAllIndex", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pairs", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<i\>\"", "<>", 
             RowBox[{"ToString", "[", "i", "]"}]}], ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "newAllIndexNumber"}], "}"}]}], "]"}], "//", 
        "ToString"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pairs", "=", 
       RowBox[{"StringTake", "[", 
        RowBox[{"pairs", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"todoString", "=", "\"\<Table[timeForm,pairs]\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"timeForm", "=", 
       RowBox[{
       "\"\<Sum[table[[\>\"", "<>", "newAnotherAllIndex", "<>", 
        "\"\<]],{ii,\>\"", "<>", 
        RowBox[{"ToString", "[", "theDim", "]"}], "<>", "\"\<}]\>\""}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"todoString", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"todoString", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<timeForm\>\"", "\[Rule]", "timeForm"}], ",", 
           RowBox[{"\"\<pairs\>\"", "\[Rule]", "pairs"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<to calculate new tensor\>\"", ",", "newStr", ",", "newDims"}], 
         "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"ToExpression", "[", "todoString", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<Value ok in tensorContract, simplifying\>\"", 
         "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"result", "=", 
         RowBox[{"Simplify", "[", "result", "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"new", "[", 
        RowBox[{"Tensor", "[", 
         RowBox[{"newStr", ",", "newDims", ",", "result"}], "]"}], "]"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tensorContract", "[", 
    RowBox[{"t1_Tensor", ",", "t2_Tensor", ",", "indexToContract_List"}], 
    "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tt", ",", "i1", ",", "i2", ",", "result", ",", "n1"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tt", "=", 
       RowBox[{"tensorProduct", "[", 
        RowBox[{"t1", ",", "t2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n1", "=", 
       RowBox[{"StringLength", "[", 
        RowBox[{"t1", ".", 
         RowBox[{"showIndexString", "[", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"i1", "=", 
       RowBox[{"indexToContract", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"i2", "=", 
       RowBox[{"indexToContract", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"tensorContract", "[", 
        RowBox[{"tt", ",", 
         RowBox[{"{", 
          RowBox[{"i1", ",", 
           RowBox[{"n1", "+", "i2"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "result", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tensorTranspose", "[", 
    RowBox[{"t_Tensor", ",", "indexToChange_List"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dim", ",", "indexStr", ",", "table", ",", "n", ",", "indexNumberStr", 
       ",", "newIndexNumberStr", ",", "newDim", ",", "newIndexStr", ",", 
       "pairs", ",", "todoString", ",", "result", ",", "i"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dim", "=", 
       RowBox[{"t", ".", 
        RowBox[{"showDim", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"indexStr", "=", 
       RowBox[{"t", ".", 
        RowBox[{"showIndex", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"table", "=", 
       RowBox[{"t", ".", 
        RowBox[{"showTable", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"StringLength", "[", 
        RowBox[{"t", ".", 
         RowBox[{"showIndexString", "[", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"indexNumberStr", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\"\<i\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newIndexNumberStr", "=", 
       RowBox[{"indexNumberStr", "//", "ToString"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newIndexNumberStr", "=", 
       RowBox[{"StringTake", "[", 
        RowBox[{"newIndexNumberStr", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newDim", "=", 
       RowBox[{"dim", "[", 
        RowBox[{"[", "indexToChange", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newIndexStr", "=", 
       RowBox[{"indexStr", "[", 
        RowBox[{"[", "indexToChange", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newIndexStr", "=", 
       RowBox[{"StringJoin", "[", "newIndexStr", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pairs", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<i\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}]}], ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pairs", "=", 
       RowBox[{
        RowBox[{"pairs", "[", 
         RowBox[{"[", "indexToChange", "]"}], "]"}], "//", "ToString"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"pairs", "=", 
       RowBox[{"StringTake", "[", 
        RowBox[{"pairs", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"todoString", "=", "\"\<Table[table[[hehe]],pairs]\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"todoString", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"todoString", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<hehe\>\"", "->", "newIndexNumberStr"}], ",", 
           RowBox[{"\"\<pairs\>\"", "\[Rule]", "pairs"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"ToExpression", "[", "todoString", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"new", "[", 
        RowBox[{"Tensor", "[", 
         RowBox[{"newIndexStr", ",", "newDim", ",", "result"}], "]"}], "]"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tensorCoordinateD", "[", 
    RowBox[{"t_Tensor", ",", "v_List"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dim", ",", "indexStr", ",", "table", ",", "n", ",", "vLength", ",", 
       "newDim", ",", "newIndexStr", ",", "newTable", ",", "result"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dim", "=", 
       RowBox[{"t", ".", 
        RowBox[{"showDim", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"indexStr", "=", 
       RowBox[{"t", ".", 
        RowBox[{"showIndexString", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"table", "=", 
       RowBox[{"t", ".", 
        RowBox[{"showTable", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"StringLength", "[", "indexStr", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vLength", "=", 
       RowBox[{"Length", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newDim", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"dim", ",", "vLength"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newIndexStr", "=", 
       RowBox[{"StringInsert", "[", 
        RowBox[{"indexStr", ",", "\"\<d\>\"", ",", 
         RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newTable", "=", 
       RowBox[{"Outer", "[", 
        RowBox[{"D", ",", "table", ",", "v"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<new table is \>\"", ",", "newTable"}], "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"new", "[", 
        RowBox[{"Tensor", "[", 
         RowBox[{"newIndexStr", ",", "newDim", ",", "newTable"}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "result", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tensorD", "[", 
     RowBox[{"t_Tensor", ",", "v_List", ",", "gama_Tensor"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", ",", "valueTable", ",", "theInd", ",", "theIndStr", ",", 
        "newDims", ",", "temp", ",", "transferListInit", ",", 
        "transferList"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"gama", ".", 
           RowBox[{"showIndexString", "[", "]"}]}], "\[NotEqual]", " ", 
          "\"\<udd\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Error \[CapitalGamma]!!!!\>\"", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "]"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"theInd", "=", 
        RowBox[{"t", ".", 
         RowBox[{"showIndex", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"theIndStr", "=", 
        RowBox[{"t", ".", 
         RowBox[{"showIndexString", "[", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newDims", "=", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"t", ".", 
           RowBox[{"showDim", "[", "]"}]}], ",", 
          RowBox[{"Length", "[", "v", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"t", ".", 
          RowBox[{"showDim", "[", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"transferListInit", "=", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "3", ",", 
              RowBox[{"1", "+", "n"}]}], "}"}]}], "]"}], ",", "2"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"temp", "=", 
        RowBox[{"tensorCoordinateD", "[", 
         RowBox[{"t", ",", "v"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<\[PartialD]x \\n\>\"", ",", 
           RowBox[{
            RowBox[{"temp", ".", 
             RowBox[{"showEqu", "[", "]"}]}], "//", "MatrixForm"}]}], "]"}], 
         ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"valueTable", "=", 
        RowBox[{"temp", ".", 
         RowBox[{"showTable", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"indI", "=", "1"}], ",", 
         RowBox[{"indI", "\[LessEqual]", " ", "n"}], ",", 
         RowBox[{"indI", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"theInd", "[", 
              RowBox[{"[", "indI", "]"}], "]"}], "\[Equal]", " ", 
             "\"\<u\>\""}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"temp", "=", 
              RowBox[{"C", "[", 
               RowBox[{"gama", ",", "t", ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "indI"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"transferList", "=", 
              RowBox[{"Insert", "[", 
               RowBox[{"transferListInit", ",", "1", ",", "indI"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"temp", "=", 
              RowBox[{"tensorTranspose", "[", 
               RowBox[{"temp", ",", "transferList"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<i=\>\"", ",", "indI", ",", "\"\<u\\n\>\"", ",", 
                 "transferList", ",", "\"\<\\n\>\"", ",", 
                 RowBox[{
                  RowBox[{"temp", ".", 
                   RowBox[{"showEqu", "[", "]"}]}], "//", "MatrixForm"}]}], 
                "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"valueTable", "=", 
              RowBox[{"valueTable", "+", 
               RowBox[{"temp", ".", 
                RowBox[{"showTable", "[", "]"}]}]}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"theInd", "[", 
                RowBox[{"[", "indI", "]"}], "]"}], "\[Equal]", " ", 
               "\"\<d\>\""}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"temp", "=", 
                RowBox[{"C", "[", 
                 RowBox[{"gama", ",", "t", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "indI"}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"transferList", "=", 
                RowBox[{"Insert", "[", 
                 RowBox[{"transferListInit", ",", "1", ",", "indI"}], "]"}]}],
                ";", "\[IndentingNewLine]", 
               RowBox[{"temp", "=", 
                RowBox[{"tensorTranspose", "[", 
                 RowBox[{"temp", ",", "transferList"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<i=\>\"", ",", "indI", ",", "\"\<d\\n\>\"", ",", 
                   "transferList", ",", "\"\<\\n\>\"", ",", 
                   RowBox[{
                    RowBox[{"temp", ".", 
                    RowBox[{"showEqu", "[", "]"}]}], "//", "MatrixForm"}]}], 
                  "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"valueTable", "=", 
                RowBox[{"valueTable", "-", 
                 RowBox[{"temp", ".", 
                  RowBox[{"showTable", "[", "]"}]}]}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", "\"\<Error in tensorD!!!!\>\"", "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"Return", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"valueTable", "=", 
          RowBox[{"Simplify", "[", "valueTable", "]"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"new", "[", 
         RowBox[{"Tensor", "[", 
          RowBox[{
           RowBox[{"theIndStr", "<>", "\"\<d\>\""}], ",", "newDims", ",", 
           "valueTable"}], "]"}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tensorSymPart", "[", 
   RowBox[{"t_Tensor", ",", "v_List"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dim", ",", "indexStr", ",", "table", ",", "n", ",", "vLength", ",", 
      "sumValue", ",", "pListInit", ",", "subPair", ",", "pList", ",", 
      "signList", ",", "newTable", ",", "thisPList", ",", "theIndex"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dim", "=", 
      RowBox[{"t", ".", 
       RowBox[{"showDim", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"indexStr", "=", 
      RowBox[{"t", ".", 
       RowBox[{"showIndexString", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"table", "=", 
      RowBox[{"t", ".", 
       RowBox[{"showTable", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"StringLength", "[", "indexStr", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vLength", "=", 
      RowBox[{"Length", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pListInit", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\"\<t\>\"", "<>", 
         RowBox[{"ToString", "[", "i", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "vLength"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"subPair", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pListInit", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
         RowBox[{"v", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "vLength"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pList", "=", 
      RowBox[{"Permutations", "[", "pListInit", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"signList", "=", 
      RowBox[{"Apply", "[", 
       RowBox[{"Signature", ",", 
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{"{", "pList", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sumValue", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"vLength", "!"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"thisPList", "=", 
         RowBox[{
          RowBox[{"pList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "/.", "subPair"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"theIndex", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"i", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"theIndex", "[", 
          RowBox[{"[", "v", "]"}], "]"}], "=", "thisPList"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sumValue", "=", 
         RowBox[{"sumValue", "+", 
          RowBox[{"Transpose", "[", 
           RowBox[{"table", ",", "theIndex"}], "]"}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"newTable", "=", 
      FractionBox["sumValue", 
       RowBox[{"vLength", "!"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"newTable", "=", 
        RowBox[{"Simplify", "[", "newTable", "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"new", "[", 
       RowBox[{"Tensor", "[", 
        RowBox[{"indexStr", ",", "dim", ",", "newTable"}], "]"}], "]"}], 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tensorAnSymPart", "[", 
   RowBox[{"t_Tensor", ",", "v_List"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dim", ",", "indexStr", ",", "table", ",", "n", ",", "vLength", ",", 
      "sumValue", ",", "pListInit", ",", "subPair", ",", "pList", ",", 
      "signList", ",", "newTable", ",", "thisPList", ",", "theIndex"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dim", "=", 
      RowBox[{"t", ".", 
       RowBox[{"showDim", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"indexStr", "=", 
      RowBox[{"t", ".", 
       RowBox[{"showIndexString", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"table", "=", 
      RowBox[{"t", ".", 
       RowBox[{"showTable", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"StringLength", "[", "indexStr", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vLength", "=", 
      RowBox[{"Length", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pListInit", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\"\<t\>\"", "<>", 
         RowBox[{"ToString", "[", "i", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "vLength"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"subPair", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pListInit", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
         RowBox[{"v", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "vLength"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pList", "=", 
      RowBox[{"Permutations", "[", "pListInit", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"signList", "=", 
      RowBox[{"Apply", "[", 
       RowBox[{"Signature", ",", 
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{"{", "pList", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sumValue", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"vLength", "!"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"thisPList", "=", 
         RowBox[{
          RowBox[{"pList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "/.", "subPair"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"theIndex", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"i", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"theIndex", "[", 
          RowBox[{"[", "v", "]"}], "]"}], "=", "thisPList"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sumValue", "=", 
         RowBox[{"sumValue", "+", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"table", ",", "theIndex"}], "]"}], "*", 
           RowBox[{"signList", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"newTable", "=", 
      FractionBox["sumValue", 
       RowBox[{"vLength", "!"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"newTable", "=", 
        RowBox[{"Simplify", "[", "newTable", "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"new", "[", 
       RowBox[{"Tensor", "[", 
        RowBox[{"indexStr", ",", "dim", ",", "newTable"}], "]"}], "]"}], 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Unprotect", "[", "C", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tPlus", "[", 
    RowBox[{"t1_Tensor", ",", "t2_Tensor"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dim1", ",", "dim2", ",", "ind1", ",", "ind2", ",", "table1", ",", 
       "table2", ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dim1", "=", 
       RowBox[{"t1", ".", 
        RowBox[{"showDim", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dim2", "=", 
       RowBox[{"t2", ".", 
        RowBox[{"showDim", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ind1", "=", 
       RowBox[{"t1", ".", 
        RowBox[{"showIndexString", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ind2", "=", 
       RowBox[{"t2", ".", 
        RowBox[{"showIndexString", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"table1", "=", 
       RowBox[{"t1", ".", 
        RowBox[{"showTable", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"table2", "=", 
       RowBox[{"t2", ".", 
        RowBox[{"showTable", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"table1", "+", "table2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"result", "=", 
         RowBox[{"Simplify", "[", "result", "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"dim1", "\[Equal]", " ", "dim2"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"ind1", "\[Equal]", " ", "ind2"}], ")"}]}], ",", 
        RowBox[{"result", "=", 
         RowBox[{"new", "[", 
          RowBox[{"Tensor", "[", 
           RowBox[{"ind1", ",", "dim1", ",", "result"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<dimension Not Match!!!\>\"", "]"}], ";", 
         RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "result", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tMinus", "[", 
    RowBox[{"t1_Tensor", ",", "t2_Tensor"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dim1", ",", "dim2", ",", "ind1", ",", "ind2", ",", "table1", ",", 
       "table2", ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dim1", "=", 
       RowBox[{"t1", ".", 
        RowBox[{"showDim", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dim2", "=", 
       RowBox[{"t2", ".", 
        RowBox[{"showDim", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ind1", "=", 
       RowBox[{"t1", ".", 
        RowBox[{"showIndexString", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ind2", "=", 
       RowBox[{"t2", ".", 
        RowBox[{"showIndexString", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"table1", "=", 
       RowBox[{"t1", ".", 
        RowBox[{"showTable", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"table2", "=", 
       RowBox[{"t2", ".", 
        RowBox[{"showTable", "[", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"table1", "-", "table2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"result", "=", 
         RowBox[{"Simplify", "[", "result", "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"dim1", "\[Equal]", " ", "dim2"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"ind1", "\[Equal]", " ", "ind2"}], ")"}]}], ",", 
        RowBox[{"result", "=", 
         RowBox[{"new", "[", 
          RowBox[{"Tensor", "[", 
           RowBox[{"ind1", ",", "dim1", ",", "result"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<dimension Not Match!!!\>\"", "]"}], ";", 
         RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "result", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"C", "[", 
    RowBox[{"t1_Tensor", ",", "t2_Tensor", ",", "indToC_List"}], "]"}], ":=", 
   RowBox[{"tensorContract", "[", 
    RowBox[{"t1", ",", "t2", ",", "indToC"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"C", "[", 
    RowBox[{"tt_Tensor", ",", "indToC_List"}], "]"}], ":=", 
   RowBox[{"tensorContract", "[", 
    RowBox[{"tt", ",", "indToC"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "C", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"indexShiftLeft", "[", 
    RowBox[{"tnum_", ",", "number_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tt", ",", "temp", ",", "tempList"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tt", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "tnum"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tempList", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "number"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"temp", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{"tt", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "number"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"temp", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"temp", ",", "tempList"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "temp", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"indexShiftRight", "[", 
    RowBox[{"tnum_", ",", "number_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"temp", ",", "len"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"len", "=", "tnum"}], ";", "\[IndentingNewLine]", 
      RowBox[{"temp", "=", 
       RowBox[{"indexShiftLeft", "[", 
        RowBox[{"tnum", ",", 
         RowBox[{"len", "-", "number"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "temp", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6200983618826256`*^9, 3.6200983620037107`*^9}, {
   3.6200984963170137`*^9, 3.6200985752310305`*^9}, {3.6200988848090687`*^9, 
   3.6200989776395407`*^9}, {3.6200990414865847`*^9, 
   3.6200991701306763`*^9}, {3.620099219826069*^9, 3.620099231185848*^9}, {
   3.6200994087731347`*^9, 3.6200994521221595`*^9}, {3.6200995155970564`*^9, 
   3.620099906170821*^9}, {3.620100006368078*^9, 3.6201000071986675`*^9}, {
   3.6201000806316495`*^9, 3.6201001175211334`*^9}, {3.6201002241179266`*^9, 
   3.620100408832258*^9}, {3.6201016804672723`*^9, 3.6201017650866203`*^9}, {
   3.6201806753923244`*^9, 3.620180681487939*^9}, {3.6201807974410686`*^9, 
   3.6201808855836706`*^9}, {3.6201832578776464`*^9, 3.620183332399989*^9}, {
   3.6201833657477694`*^9, 3.6201833681064444`*^9}, {3.620183406622635*^9, 
   3.620183410975726*^9}, {3.62018616442916*^9, 3.6201863571318808`*^9}, {
   3.620186598532468*^9, 3.620186598866688*^9}, {3.620187235406926*^9, 
   3.6201873003467264`*^9}, {3.620187645268918*^9, 3.6201876838988743`*^9}, {
   3.620189685857894*^9, 3.6201897793409767`*^9}, {3.620189840200182*^9, 
   3.620189889191949*^9}, {3.6201899375773*^9, 3.6201899401541104`*^9}, 
   3.6201927594956865`*^9, 3.6201930968370385`*^9, {3.6201931526726894`*^9, 
   3.62019316076143*^9}, {3.6201931915591593`*^9, 3.6201931919054165`*^9}, {
   3.6201932903511887`*^9, 3.620193301206391*^9}, {3.6201936705220165`*^9, 
   3.620193679302231*^9}, {3.6201944104927006`*^9, 3.620194424232938*^9}, {
   3.6202017646479454`*^9, 3.620201792087912*^9}, {3.620201868272443*^9, 
   3.6202019046239614`*^9}, {3.620201964976993*^9, 3.6202019907782774`*^9}, {
   3.620202037905897*^9, 3.620202072817427*^9}, {3.6202024259889083`*^9, 
   3.6202024949653625`*^9}, {3.620202537350088*^9, 3.6202025590470247`*^9}, {
   3.6202026259948425`*^9, 3.6202026670083046`*^9}, {3.620202723401459*^9, 
   3.620202774103241*^9}, {3.6202031664383698`*^9, 3.620203168338708*^9}, {
   3.6202038167039003`*^9, 3.6202038221227484`*^9}, {3.620208763303317*^9, 
   3.6202087645742006`*^9}, {3.6202107184857407`*^9, 
   3.6202109634345446`*^9}, {3.620211046645526*^9, 3.620211048990183*^9}, {
   3.6202116161025324`*^9, 3.62021162048208*^9}, {3.6202136647104006`*^9, 
   3.6202136647694426`*^9}, {3.6202137181380897`*^9, 3.620213719079771*^9}, {
   3.620254062820995*^9, 3.620254093508774*^9}, {3.620254139672201*^9, 
   3.6202541408180075`*^9}, {3.620254179591555*^9, 3.620254447710126*^9}, {
   3.6202545158226395`*^9, 3.6202545285987053`*^9}, {3.6202545640675926`*^9, 
   3.6202546686629095`*^9}, {3.620254719873583*^9, 3.6202547437931833`*^9}, {
   3.6202547792518864`*^9, 3.620254790898535*^9}, {3.620254827520441*^9, 
   3.6202549557058835`*^9}, {3.6202550314415073`*^9, 
   3.6202550372486305`*^9}, {3.6202550745059786`*^9, 3.620255107928379*^9}, {
   3.6202551586545525`*^9, 3.6202551611733427`*^9}, {3.6202551981591787`*^9, 
   3.6202552068593574`*^9}, {3.620255237209468*^9, 3.62025541084721*^9}, {
   3.620255512441442*^9, 3.6202555789691877`*^9}, {3.6202561185566673`*^9, 
   3.6202561365061193`*^9}, {3.620257760262517*^9, 3.6202577613182774`*^9}, {
   3.6202579302031517`*^9, 3.6202579303872714`*^9}, {3.620258194349907*^9, 
   3.620258195324602*^9}, {3.620258276741008*^9, 3.6202582822279043`*^9}, {
   3.6202646239357185`*^9, 3.6202646337219353`*^9}, {3.6202646746359196`*^9, 
   3.6202646961440754`*^9}, {3.620264741440711*^9, 3.620264746498338*^9}, {
   3.622236744442748*^9, 3.622236771626342*^9}, {3.622237619906724*^9, 
   3.6222376570702043`*^9}, {3.6222437310195537`*^9, 3.622243801606332*^9}, {
   3.622243861846336*^9, 3.622243948783761*^9}, {3.6222440297089725`*^9, 
   3.6222440336527586`*^9}, {3.6222441098293085`*^9, 3.622244165355335*^9}, {
   3.622244223489109*^9, 3.622244272161838*^9}, {3.6222443295103836`*^9, 
   3.622244339794914*^9}, {3.6222443707314296`*^9, 3.6222443709155483`*^9}, {
   3.622244474556004*^9, 3.6222444811048117`*^9}, {3.6222445234695153`*^9, 
   3.622244524677373*^9}, {3.6222446064332027`*^9, 3.622244681847596*^9}, {
   3.6222453184277916`*^9, 3.6222453338597345`*^9}, {3.6222454179171357`*^9, 
   3.6222454292931023`*^9}, {3.6222454916914377`*^9, 3.622245495456117*^9}, {
   3.6222455374546714`*^9, 3.6222455783398647`*^9}, {3.6222456743635283`*^9, 
   3.622245861177075*^9}, {3.62224694050045*^9, 3.622246963597994*^9}, 
   3.622247043580877*^9, {3.6222471015745497`*^9, 3.622247119839413*^9}, {
   3.622247175290436*^9, 3.622247210506618*^9}, {3.62224725895863*^9, 
   3.622247259270846*^9}, {3.622247303689241*^9, 3.6222473285244603`*^9}, {
   3.622247405339986*^9, 3.622247405806348*^9}, {3.622247483003374*^9, 
   3.6222475054066544`*^9}, {3.622248222553605*^9, 3.622248286073781*^9}, {
   3.6222483339371567`*^9, 3.622248341934183*^9}, {3.6222483740030136`*^9, 
   3.6222483892931776`*^9}, 3.622248569651329*^9, {3.6222488415335903`*^9, 
   3.6222488549701343`*^9}, {3.6222734009187326`*^9, 
   3.6222734183001013`*^9}, {3.622273451748191*^9, 3.6222734607745953`*^9}, {
   3.6222735091788673`*^9, 3.6222735886803703`*^9}, {3.6222746974422045`*^9, 
   3.6222747146296325`*^9}, {3.6222755090470386`*^9, 3.62227553538284*^9}, {
   3.6222755966820765`*^9, 3.6222756395630274`*^9}, {3.6222757301391287`*^9, 
   3.622275765181015*^9}, {3.6222758041449375`*^9, 3.6222758047174873`*^9}, {
   3.622275893551992*^9, 3.622275895001211*^9}, {3.6222761151146145`*^9, 
   3.62227612874712*^9}, {3.622276191020807*^9, 3.622276207139965*^9}, {
   3.622276785138432*^9, 3.6222769349025927`*^9}, {3.622276993939645*^9, 
   3.622277191181142*^9}, {3.622277243046834*^9, 3.622277288181223*^9}, {
   3.6222773255847616`*^9, 3.6222773294687552`*^9}, {3.622277360202902*^9, 
   3.622277423145006*^9}, {3.6222774647428827`*^9, 3.622277605034225*^9}, {
   3.6222776738907948`*^9, 3.622277753379984*^9}, 3.6222778709544387`*^9, 
   3.6222787316906557`*^9, {3.6223437383266144`*^9, 3.622343858446637*^9}, {
   3.6223439175429974`*^9, 3.6223439418630333`*^9}, {3.622343985382968*^9, 
   3.6223441905301027`*^9}, {3.622344237950881*^9, 3.6223442449611073`*^9}, {
   3.6223442880696163`*^9, 3.622344376735342*^9}, {3.6223444427680225`*^9, 
   3.6223445743689337`*^9}, {3.622344611243284*^9, 3.622344615998629*^9}, {
   3.6223448917162886`*^9, 3.622344930884654*^9}, {3.6223449764434896`*^9, 
   3.6223449764775143`*^9}, {3.6223452236279783`*^9, 3.622345229853381*^9}, {
   3.622345270795422*^9, 3.622345291409398*^9}, {3.622345437145314*^9, 
   3.6223454777240543`*^9}, {3.622345507901725*^9, 3.6223455111710463`*^9}, {
   3.6223455846251802`*^9, 3.62234558641247*^9}, {3.6223456406677446`*^9, 
   3.6223456421317997`*^9}, {3.622345728197836*^9, 3.622345754976513*^9}, {
   3.622345786515567*^9, 3.622345821324829*^9}, {3.6223458735078745`*^9, 
   3.622345878175207*^9}, {3.622345953952108*^9, 3.6223460411738987`*^9}, {
   3.622346099539113*^9, 3.622346118564683*^9}, {3.6223461609843664`*^9, 
   3.6223461704633503`*^9}, {3.622346223251427*^9, 3.622346223671714*^9}, {
   3.6223462867512407`*^9, 3.622346288865759*^9}, {3.622346453270149*^9, 
   3.6223464549002876`*^9}, {3.6223465680817146`*^9, 
   3.6223465734205046`*^9}, {3.622346605936077*^9, 3.622346606283343*^9}, {
   3.6223470173181434`*^9, 3.6223470236246204`*^9}, {3.6223470765714626`*^9, 
   3.622347145096383*^9}, {3.62234757802559*^9, 3.6223476048946652`*^9}, {
   3.6223489493031955`*^9, 3.622348955742764*^9}, {3.6223490004318094`*^9, 
   3.6223490033718977`*^9}, {3.622349102163658*^9, 3.622349131876658*^9}, {
   3.622349258842166*^9, 3.622349259095339*^9}, {3.622350103270835*^9, 
   3.622350105082119*^9}, {3.6223501351282773`*^9, 3.6223501473969817`*^9}, {
   3.6223502126010523`*^9, 3.622350226716079*^9}, {3.622350630714509*^9, 
   3.622350634862447*^9}, {3.622350819904791*^9, 3.6223508267987022`*^9}, {
   3.6223509143436236`*^9, 3.6223509158806877`*^9}, {3.6223511891022844`*^9, 
   3.6223512294489293`*^9}, {3.622352398588543*^9, 3.6223524423526897`*^9}, {
   3.6223525134109783`*^9, 3.6223525264373207`*^9}, {3.622353363973754*^9, 
   3.622353386692039*^9}, {3.6223535255900383`*^9, 3.6223535395919867`*^9}, {
   3.622353604860916*^9, 3.622353604947981*^9}, {3.6223586154799395`*^9, 
   3.6223586347724457`*^9}, {3.6223607033162756`*^9, 
   3.6223607607036047`*^9}, {3.6223608609533877`*^9, 3.622360897424568*^9}, {
   3.622361243677967*^9, 3.622361259508809*^9}, {3.6223613800685797`*^9, 
   3.6223613830829277`*^9}, {3.622361514499961*^9, 3.622361534575963*^9}, {
   3.6223624067412767`*^9, 3.6223624596791477`*^9}, {3.6223625587515383`*^9, 
   3.622362564792404*^9}, {3.6223627269373055`*^9, 3.6223627408591323`*^9}, {
   3.622362907333333*^9, 3.6223629198273563`*^9}, {3.622365597713786*^9, 
   3.622365605238752*^9}, {3.622365667961133*^9, 3.6223657066592364`*^9}, {
   3.6223657379282694`*^9, 3.6223657423590393`*^9}, {3.6223658114532824`*^9, 
   3.6223659032894473`*^9}, {3.622365951990878*^9, 3.6223661549857597`*^9}, {
   3.62236626369549*^9, 3.6223663222706623`*^9}, {3.6223663586765924`*^9, 
   3.6223665164423985`*^9}, {3.6223665751722164`*^9, 
   3.6223666908143587`*^9}, {3.622366804730255*^9, 3.622366814404595*^9}, {
   3.6223670022758856`*^9, 3.6223670426852016`*^9}, {3.6223671533011293`*^9, 
   3.6223671991447773`*^9}, {3.622367240666873*^9, 3.622367268801504*^9}, {
   3.6223673665146694`*^9, 3.6223673775302925`*^9}, 3.622367463482738*^9, {
   3.6223675224463496`*^9, 3.6223675552331896`*^9}, {3.6223676482693768`*^9, 
   3.6223676668448725`*^9}, {3.622367736396738*^9, 3.6223677421749735`*^9}, {
   3.6223678424371586`*^9, 3.622367846189856*^9}, {3.6223679853090687`*^9, 
   3.6223680148156433`*^9}, {3.6223681945251637`*^9, 
   3.6223682148216076`*^9}, {3.6223685362762027`*^9, 3.622368545923355*^9}, {
   3.622368750369133*^9, 3.6223687562530537`*^9}, {3.6223695285685906`*^9, 
   3.6223695525381517`*^9}, {3.622369910275509*^9, 3.622369929078582*^9}, {
   3.622370919926377*^9, 3.6223710074840555`*^9}, {3.622371123785653*^9, 
   3.6223711417166595`*^9}, {3.6223711859163575`*^9, 
   3.6223712020276775`*^9}, {3.6223712356457925`*^9, 
   3.6223712490554385`*^9}, {3.622371293359307*^9, 3.6223714053203325`*^9}, {
   3.622371586020071*^9, 3.622371587594189*^9}, {3.622371751246964*^9, 
   3.6223717833633137`*^9}, {3.6223719078341017`*^9, 3.622371930892576*^9}, {
   3.6223719841452227`*^9, 3.6223719905190716`*^9}, {3.622372034604966*^9, 
   3.622372037622946*^9}, {3.62237207440308*^9, 3.62237207561444*^9}, {
   3.6223773685756383`*^9, 3.622377416021866*^9}, {3.622377912099573*^9, 
   3.6223779191101475`*^9}, {3.6223781044041004`*^9, 3.622378129215287*^9}, 
   3.6223782305297976`*^9, {3.622378330726289*^9, 3.6223783432924814`*^9}, {
   3.622378380780612*^9, 3.622378380942725*^9}, {3.6223784272829847`*^9, 
   3.622378427383037*^9}, {3.622378713413989*^9, 3.622378961979112*^9}, {
   3.6224112640456142`*^9, 3.622411264345804*^9}, {3.622413151111123*^9, 
   3.6224137378848686`*^9}, {3.622417328415142*^9, 3.622418498524993*^9}, {
   3.6224266620683064`*^9, 3.6224279403190928`*^9}, {3.62243766106287*^9, 
   3.6224401525821037`*^9}, {3.6224414596353836`*^9, 3.622441463663376*^9}, {
   3.622444602365631*^9, 3.622444723824462*^9}, {3.622445782975238*^9, 
   3.622447138649445*^9}, {3.622448396832563*^9, 3.622449107134205*^9}, {
   3.622450134288066*^9, 3.6224519080999327`*^9}, {3.622457759274003*^9, 
   3.6224596280590916`*^9}, {3.622498712688649*^9, 3.6224993547351465`*^9}, 
   3.6225021423645773`*^9}],

Cell[BoxData["\<\"Author: \
wujin\\nEmail:wujinnnnn@gmail.com\\nLicense:GPL\"\>"], "Print",
 CellChangeTimes->{
  3.622236260694293*^9, 3.6222372985269403`*^9, 3.6222439534330664`*^9, 
   3.6222440345383677`*^9, 3.6222441726016064`*^9, 3.622244278566814*^9, 
   3.6222443110110245`*^9, {3.6222444356918793`*^9, 3.6222444832322893`*^9}, 
   3.622244526409864*^9, 3.6222458858143663`*^9, 3.6222469682842913`*^9, 
   3.622247050477641*^9, 3.6222471369042015`*^9, 3.622247215600788*^9, 
   3.622247264441386*^9, 3.622247332317129*^9, 3.622247431040655*^9, 
   3.6222475105212593`*^9, 3.6222482905089*^9, 3.6222483483226547`*^9, 
   3.6222483978580136`*^9, 3.622248585711724*^9, 3.622272609172244*^9, 
   3.6222746268877993`*^9, 3.622274666586423*^9, 3.6222747198073072`*^9, 
   3.6222749877569304`*^9, {3.622275576415108*^9, 3.6222756052074723`*^9}, 
   3.6222756534407673`*^9, 3.6222757690266895`*^9, 3.6222758091861415`*^9, 
   3.6222761326411324`*^9, 3.6222762215427103`*^9, 3.6222776106820307`*^9, 
   3.6222779273850946`*^9, {3.622344644828744*^9, 3.622344658654746*^9}, 
   3.6223449361161985`*^9, 3.6223449792334538`*^9, {3.622345296156749*^9, 
   3.6223453121054363`*^9}, 3.6223453491512027`*^9, 3.6223453842238946`*^9, 
   3.6223454518937893`*^9, 3.6223455139614506`*^9, 3.6223455898986397`*^9, 
   3.6223456713620787`*^9, 3.622345757145034*^9, 3.622345798108758*^9, 
   3.622345838324325*^9, {3.6223460509668217`*^9, 3.6223460748363657`*^9}, 
   3.622346122757109*^9, 3.6223461735815344`*^9, 3.6223462930016823`*^9, 
   3.6223463618057785`*^9, 3.6223464598075924`*^9, 3.6223465758538003`*^9, 
   3.622346670594654*^9, 3.622347026512507*^9, {3.62234708534179*^9, 
   3.6223471254940777`*^9}, 3.6223471585118876`*^9, 3.6223476080953307`*^9, 
   3.622348056253081*^9, 3.6223485500899744`*^9, 3.6223491336082277`*^9, 
   3.6223501488049808`*^9, 3.622350231864727*^9, 3.6223506355639668`*^9, 
   3.622350828010544*^9, 3.622350916912418*^9, 3.6223512316054583`*^9, 
   3.6223524142616687`*^9, 3.6223524544712934`*^9, 3.622352528218579*^9, 
   3.622353316841628*^9, 3.6223533914624324`*^9, 3.622353540261454*^9, 
   3.622353576541745*^9, 3.622353777275485*^9, 3.622358593789888*^9, 
   3.6223586381064663`*^9, 3.6223609094718027`*^9, 3.6223612681736383`*^9, 
   3.622361392795207*^9, 3.622361543818626*^9, 3.6223623553798857`*^9, 
   3.6223624703530827`*^9, 3.622362570210209*^9, 3.6223627496762514`*^9, 
   3.6223627974542403`*^9, 3.6223629300996876`*^9, 3.622363185328081*^9, 
   3.622363321620161*^9, 3.6223657617590756`*^9, 3.6223668956791935`*^9, 
   3.6223669550549192`*^9, 3.622367076967472*^9, 3.6223671736369677`*^9, 
   3.622367273781358*^9, 3.6223673854646287`*^9, 3.6223674667596874`*^9, 
   3.6223675591293507`*^9, 3.6223676743992014`*^9, 3.622367751514555*^9, 
   3.6223680285970893`*^9, 3.622368256969607*^9, 3.6223685929002485`*^9, 
   3.6223689042639084`*^9, 3.6223695646365557`*^9, 3.622369931476587*^9, 
   3.6223700462435093`*^9, 3.622371447410174*^9, 3.6223715908755035`*^9, 
   3.6223717550936975`*^9, 3.6223717862347565`*^9, 3.622371961983509*^9, 
   3.622371992888167*^9, 3.62237210661835*^9, 3.622372285372225*^9, 
   3.6223724779141235`*^9, 3.622377043195514*^9, 3.622377136795169*^9, 
   3.6223772709034843`*^9, 3.622377419764213*^9, 3.622377455592744*^9, 
   3.6223779308426433`*^9, 3.622378139715185*^9, 3.622378233509407*^9, 
   3.622378346072748*^9, 3.6223783842098975`*^9, 3.622378429637388*^9, 
   3.62237849855354*^9, 3.6223789665007954`*^9, 3.6224081660536804`*^9, 
   3.62240934953234*^9, {3.622411190634035*^9, 3.6224113439450197`*^9}, {
   3.6224126215938635`*^9, 3.6224145914872694`*^9}, {3.6224173597783937`*^9, 
   3.6224185321178246`*^9}, {3.62242487625296*^9, 3.6224278482372723`*^9}, {
   3.6224376731429324`*^9, 3.622440154266573*^9}, {3.622441563164476*^9, 
   3.6224420961048965`*^9}, {3.622444044234707*^9, 3.6224449792595506`*^9}, {
   3.622446474913951*^9, 3.6224491117381053`*^9}, {3.6224503041917253`*^9, 
   3.622450934513017*^9}, {3.6224520218460064`*^9, 3.622452260448103*^9}, {
   3.622457919474248*^9, 3.6224602628276997`*^9}, {3.622498736767045*^9, 
   3.622499390788435*^9}}]
}, Open  ]]
},
WindowSize->{524, 661},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Landscape",
"PaperSize"->{841.68, 595.1999999999999}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (July 1, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 84829, 2026, 10960, "Input"],
Cell[85412, 2050, 4133, 57, 62, "Print"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
